import{T as F,K as S,p as f,y as T,o as i,f as r,a as p,u as a,c as $,g as l,w as D,b as v,n as E,t as K,e as L,d as M}from"./app-164847fe.js";import Z from"./Loader-3b1f2cf3.js";import A from"./FieldCombobox-93d1b27d.js";import c from"./FieldInput-511b4bcd.js";import G from"./FieldSelectDentists-0a30a1f7.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./index-f9c786fa.js";import"./LoaderSmall-3aefc194.js";import"./combobox-18eaa232.js";import"./hidden-6e550821.js";import"./use-tracked-pointer-138e0f0a.js";import"./disposables-ed35e013.js";import"./ChevronUpDownIcon-a9d4d143.js";import"./listbox-bbb56993.js";const H=["onSubmit"],J={key:1},Q={key:4,class:"border-t pt-2"},R=v("h5",{class:"font-semibold"},"Novi pacijent",-1),W={class:"flex items-end"},X={key:0},be={__name:"FormBooking",props:{appointment:{type:Object,required:!1},selectedPatient:{type:Object,required:!1},date:Object,data:{type:Object,required:!1},edit:{type:Boolean,required:!1}},emits:["success","delete"],setup(u,{emit:N}){var _,y,k,V,g,j,h,w,x;const n=u,e=F({_method:"post",date:((_=n.date)==null?void 0:_.date)||null,dentist_id:((y=n==null?void 0:n.data)==null?void 0:y.dentist_id)||(((g=(V=(k=S())==null?void 0:k.props.auth)==null?void 0:V.user)==null?void 0:g.role)===2?(h=(j=S())==null?void 0:j.props.auth)==null?void 0:h.user:0),patient_id:((w=n==null?void 0:n.data)==null?void 0:w.patient_id)||null,new_patient:!1,first_name:null,last_name:null,phone:null}),m=f(!1),U=f(((x=n==null?void 0:n.data)==null?void 0:x.patient_id)||null),s=f(!1),b=f({}),q=()=>{var d,t;m.value=!0,n.edit&&(e._method="put"),e.post(n.edit?route("appointments.update_users",{id:((t=(d=n==null?void 0:n.appointment)==null?void 0:d._def)==null?void 0:t.publicId)??null}):route("appointments.store"),{preserveScroll:!0,onSuccess:()=>{N("success")},onFinish:()=>{m.value=!1}})};return(d,t)=>{var z,B,C,I,P;const O=T("inertia-link");return i(),r("form",{onSubmit:L(q,["prevent"]),class:"space-y-2"},[p(G,{modelValue:a(e).dentist_id,"onUpdate:modelValue":t[0]||(t[0]=o=>a(e).dentist_id=o),type:"dentist",items:d.$page.props.global.dentists.data,name:"dentist_id",label:u.edit?"Izabran doktor":"Izaberite doktora",error:(z=a(e).errors)==null?void 0:z.dentist_id},null,8,["modelValue","items","label","error"]),s.value?l("",!0):(i(),$(A,{key:0,modelValue:a(e).patient_id,"onUpdate:modelValue":t[1]||(t[1]=o=>a(e).patient_id=o),items:U.value,name:"patient_id",label:u.edit?"Izabran pacijent":"Izaberite pacijenta",error:(B=a(e).errors)==null?void 0:B.patient_id,onSearched:t[2]||(t[2]=o=>b.value=o)},null,8,["modelValue","items","label","error"])),u.edit&&a(e).patient_id?(i(),r("div",J,[p(O,{href:d.route("patients.show",{slug:a(e).patient_id.slug}),class:"mt-4 ml-2 underline"},{default:D(()=>[M("Pogledaj pacijenta")]),_:1},8,["href"])])):l("",!0),b.value.length<1&&!s.value?(i(),r("button",{key:2,type:"button",class:"text-red-500 underline",onClick:t[3]||(t[3]=()=>{a(e).new_patient=!0,s.value=!0})}," Pacijent ne postoji u bazi? ")):l("",!0),b.value.length<1&&s.value?(i(),r("button",{key:3,type:"button",class:"pb-2 text-red-500 underline",onClick:t[4]||(t[4]=()=>{a(e).new_patient=!1,s.value=!1})}," Ponovo pokušaj pretragu? ")):l("",!0),b.value.length<1&&s.value?(i(),r("div",Q,[R,p(c,{modelValue:a(e).first_name,"onUpdate:modelValue":t[5]||(t[5]=o=>a(e).first_name=o),name:"first_name",label:"Ime pacijenta",error:(C=a(e).errors)==null?void 0:C.first_name},null,8,["modelValue","error"]),p(c,{modelValue:a(e).last_name,"onUpdate:modelValue":t[6]||(t[6]=o=>a(e).last_name=o),name:"last_name",label:"Prezime pacijenta",error:(I=a(e).errors)==null?void 0:I.last_name},null,8,["modelValue","error"]),p(c,{modelValue:a(e).phone,"onUpdate:modelValue":t[7]||(t[7]=o=>a(e).phone=o),name:"phone",label:"Broj telefona pacijenta",error:(P=a(e).errors)==null?void 0:P.phone},null,8,["modelValue","error"])])):l("",!0),v("div",W,[u.edit?(i(),r("button",{key:0,type:"button",onClick:t[8]||(t[8]=o=>d.$emit("delete",{id:a(e).record})),class:"mr-auto text-red-500 hover:underline"},"Izbriši zakazano")):l("",!0),v("button",{type:"submit",class:E([m.value?"opacity-25":"","focus-visible:ring-ring border-input mb-4 ml-auto inline-flex w-full items-center justify-center space-x-2 rounded-xl border bg-emerald-600 px-6 py-2 text-base font-medium text-white shadow-sm transition-colors hover:bg-emerald-700 hover:text-white focus-visible:outline-none focus-visible:ring-1 disabled:pointer-events-none disabled:opacity-50 sm:mb-0 sm:mt-4 sm:w-[200px]"])},[m.value?l("",!0):(i(),r("span",X,K("Zakaži"))),m.value?(i(),$(Z,{key:1,class:"w-[56px]"})):l("",!0)],2)])],40,H)}}};export{be as default};
