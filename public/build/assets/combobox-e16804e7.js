import{m as Q,u as $,o as y,y as Z,c as ee,l as U,f as te,K as oe,a as ae,H as L,T as X,t as H,N as J,p as le,O as ne,b as k}from"./hidden-c9556a5a.js";import{d as ue,x as ie,a as T,e as re,b as se,u as ve}from"./use-tracked-pointer-cca63930.js";import{H as W,k as M,p as A,h as f,J as c,E as pe,y as G,q as _,l as Y,F as de,G as be,I as ce,L as j}from"./app-c9b883a8.js";import{o as fe,n as me}from"./disposables-ed35e013.js";function xe({container:o,accept:g,walk:h,enabled:P}){W(()=>{let e=o.value;if(!e||P!==void 0&&!P.value)return;let t=Q(o);if(!t)return;let m=Object.assign(u=>g(u),{acceptNode:g}),r=t.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,m,!1);for(;r.nextNode();)h(r.currentNode)})}function Oe(o,g){return o===g}var ge=(o=>(o[o.Open=0]="Open",o[o.Closed=1]="Closed",o))(ge||{}),Re=(o=>(o[o.Single=0]="Single",o[o.Multi=1]="Multi",o))(Re||{}),Se=(o=>(o[o.Pointer=0]="Pointer",o[o.Other=1]="Other",o))(Se||{});let z=Symbol("ComboboxContext");function K(o){let g=ce(z,null);if(g===null){let h=new Error(`<${o} /> is missing a parent <Combobox /> component.`);throw Error.captureStackTrace&&Error.captureStackTrace(h,K),h}return g}let Pe=M({name:"Combobox",emits:{"update:modelValue":o=>!0},props:{as:{type:[Object,String],default:"template"},disabled:{type:[Boolean],default:!1},by:{type:[String,Function],default:()=>Oe},modelValue:{type:[Object,String,Number,Boolean],default:void 0},defaultValue:{type:[Object,String,Number,Boolean],default:void 0},form:{type:String,optional:!0},name:{type:String,optional:!0},nullable:{type:Boolean,default:!1},multiple:{type:[Boolean],default:!1}},inheritAttrs:!1,setup(o,{slots:g,attrs:h,emit:P}){let e=A(1),t=A(null),m=A(null),r=A(null),u=A(null),d=A({static:!1,hold:!1}),b=A([]),x=A(null),E=A(1),V=A(!1);function B(l=s=>s){let s=x.value!==null?b.value[x.value]:null,v=ne(l(b.value.slice()),p=>y(p.dataRef.domRef)),n=s?v.indexOf(s):null;return n===-1&&(n=null),{options:v,activeOptionIndex:n}}let w=f(()=>o.multiple?1:0),O=f(()=>o.nullable),[a,R]=ue(f(()=>o.modelValue),l=>P("update:modelValue",l),f(()=>o.defaultValue)),S=f(()=>a.value===void 0?$(w.value,{1:[],0:void 0}):a.value),F=null,C=null,i={comboboxState:e,value:S,mode:w,compare(l,s){if(typeof o.by=="string"){let v=o.by;return(l==null?void 0:l[v])===(s==null?void 0:s[v])}return o.by(l,s)},defaultValue:f(()=>o.defaultValue),nullable:O,inputRef:m,labelRef:t,buttonRef:r,optionsRef:u,disabled:f(()=>o.disabled),options:b,change(l){R(l)},activeOptionIndex:f(()=>{if(V.value&&x.value===null&&b.value.length>0){let l=b.value.findIndex(s=>!s.dataRef.disabled);l!==-1&&(x.value=l)}return x.value}),activationTrigger:E,optionsPropsRef:d,closeCombobox(){V.value=!1,!o.disabled&&e.value!==1&&(e.value=1,x.value=null)},openCombobox(){if(V.value=!0,o.disabled||e.value===0)return;let l=b.value.findIndex(s=>{let v=c(s.dataRef.value);return $(w.value,{0:()=>i.compare(c(i.value.value),c(v)),1:()=>c(i.value.value).some(n=>i.compare(c(n),c(v)))})});l!==-1&&(x.value=l),e.value=0},goToOption(l,s,v){V.value=!1,F!==null&&cancelAnimationFrame(F),F=requestAnimationFrame(()=>{if(o.disabled||u.value&&!d.value.static&&e.value===1)return;let n=B();if(n.activeOptionIndex===null){let I=n.options.findIndex(q=>!q.dataRef.disabled);I!==-1&&(n.activeOptionIndex=I)}let p=ie(l===T.Specific?{focus:T.Specific,id:s}:{focus:l},{resolveItems:()=>n.options,resolveActiveIndex:()=>n.activeOptionIndex,resolveId:I=>I.id,resolveDisabled:I=>I.dataRef.disabled});x.value=p,E.value=v??1,b.value=n.options})},selectOption(l){let s=b.value.find(n=>n.id===l);if(!s)return;let{dataRef:v}=s;R($(w.value,{0:()=>v.value,1:()=>{let n=c(i.value.value).slice(),p=c(v.value),I=n.findIndex(q=>i.compare(p,c(q)));return I===-1?n.push(p):n.splice(I,1),n}}))},selectActiveOption(){if(i.activeOptionIndex.value===null)return;let{dataRef:l,id:s}=b.value[i.activeOptionIndex.value];R($(w.value,{0:()=>l.value,1:()=>{let v=c(i.value.value).slice(),n=c(l.value),p=v.findIndex(I=>i.compare(n,c(I)));return p===-1?v.push(n):v.splice(p,1),v}})),i.goToOption(T.Specific,s)},registerOption(l,s){C&&cancelAnimationFrame(C);let v={id:l,dataRef:s},n=B(p=>(p.push(v),p));if(x.value===null){let p=s.value.value;$(w.value,{0:()=>i.compare(c(i.value.value),c(p)),1:()=>c(i.value.value).some(I=>i.compare(c(I),c(p)))})&&(n.activeOptionIndex=n.options.indexOf(v))}b.value=n.options,x.value=n.activeOptionIndex,E.value=1,n.options.some(p=>!y(p.dataRef.domRef))&&(C=requestAnimationFrame(()=>{let p=B();b.value=p.options,x.value=p.activeOptionIndex}))},unregisterOption(l){var s;i.activeOptionIndex.value!==null&&((s=i.options.value[i.activeOptionIndex.value])==null?void 0:s.id)===l&&(V.value=!0);let v=B(n=>{let p=n.findIndex(I=>I.id===l);return p!==-1&&n.splice(p,1),n});b.value=v.options,x.value=v.activeOptionIndex,E.value=1}};Z([m,r,u],()=>i.closeCombobox(),f(()=>e.value===0)),pe(z,i),ee(f(()=>$(e.value,{0:U.Open,1:U.Closed})));let D=f(()=>i.activeOptionIndex.value===null?null:b.value[i.activeOptionIndex.value].dataRef.value),N=f(()=>{var l;return(l=y(m))==null?void 0:l.closest("form")});return G(()=>{_([N],()=>{if(!N.value||o.defaultValue===void 0)return;function l(){i.change(o.defaultValue)}return N.value.addEventListener("reset",l),()=>{var s;(s=N.value)==null||s.removeEventListener("reset",l)}},{immediate:!0})}),()=>{let{name:l,disabled:s,form:v,...n}=o,p={open:e.value===0,disabled:s,activeIndex:i.activeOptionIndex.value,activeOption:D.value,value:S.value};return Y(de,[...l!=null&&S.value!=null?re({[l]:S.value}).map(([I,q])=>Y(te,oe({features:ae.Hidden,key:I,as:"input",type:"hidden",hidden:!0,readOnly:!0,form:v,name:I,value:q}))):[],L({theirProps:{...h,...X(n,["modelValue","defaultValue","nullable","multiple","onUpdate:modelValue","by"])},ourProps:{},slot:p,slots:g,attrs:h,name:"Combobox"})])}}}),Te=M({name:"ComboboxLabel",props:{as:{type:[Object,String],default:"label"},id:{type:String,default:()=>`headlessui-combobox-label-${H()}`}},setup(o,{attrs:g,slots:h}){let P=K("ComboboxLabel");function e(){var t;(t=y(P.inputRef))==null||t.focus({preventScroll:!0})}return()=>{let t={open:P.comboboxState.value===0,disabled:P.disabled.value},{id:m,...r}=o,u={id:m,ref:P.labelRef,onClick:e};return L({ourProps:u,theirProps:r,slot:t,attrs:g,slots:h,name:"ComboboxLabel"})}}}),Ee=M({name:"ComboboxButton",props:{as:{type:[Object,String],default:"button"},id:{type:String,default:()=>`headlessui-combobox-button-${H()}`}},setup(o,{attrs:g,slots:h,expose:P}){let e=K("ComboboxButton");P({el:e.buttonRef,$el:e.buttonRef});function t(u){e.disabled.value||(e.comboboxState.value===0?e.closeCombobox():(u.preventDefault(),e.openCombobox()),j(()=>{var d;return(d=y(e.inputRef))==null?void 0:d.focus({preventScroll:!0})}))}function m(u){switch(u.key){case k.ArrowDown:u.preventDefault(),u.stopPropagation(),e.comboboxState.value===1&&e.openCombobox(),j(()=>{var d;return(d=e.inputRef.value)==null?void 0:d.focus({preventScroll:!0})});return;case k.ArrowUp:u.preventDefault(),u.stopPropagation(),e.comboboxState.value===1&&(e.openCombobox(),j(()=>{e.value.value||e.goToOption(T.Last)})),j(()=>{var d;return(d=e.inputRef.value)==null?void 0:d.focus({preventScroll:!0})});return;case k.Escape:if(e.comboboxState.value!==0)return;u.preventDefault(),e.optionsRef.value&&!e.optionsPropsRef.value.static&&u.stopPropagation(),e.closeCombobox(),j(()=>{var d;return(d=e.inputRef.value)==null?void 0:d.focus({preventScroll:!0})});return}}let r=se(f(()=>({as:o.as,type:g.type})),e.buttonRef);return()=>{var u,d;let b={open:e.comboboxState.value===0,disabled:e.disabled.value,value:e.value.value},{id:x,...E}=o,V={ref:e.buttonRef,id:x,type:r.value,tabindex:"-1","aria-haspopup":"listbox","aria-controls":(u=y(e.optionsRef))==null?void 0:u.id,"aria-expanded":e.comboboxState.value===0,"aria-labelledby":e.labelRef.value?[(d=y(e.labelRef))==null?void 0:d.id,x].join(" "):void 0,disabled:e.disabled.value===!0?!0:void 0,onKeydown:m,onClick:t};return L({ourProps:V,theirProps:E,slot:b,attrs:g,slots:h,name:"ComboboxButton"})}}}),Ve=M({name:"ComboboxInput",props:{as:{type:[Object,String],default:"input"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0},displayValue:{type:Function},defaultValue:{type:String,default:void 0},id:{type:String,default:()=>`headlessui-combobox-input-${H()}`}},emits:{change:o=>!0},setup(o,{emit:g,attrs:h,slots:P,expose:e}){let t=K("ComboboxInput"),m=f(()=>Q(y(t.inputRef))),r={value:!1};e({el:t.inputRef,$el:t.inputRef});function u(){t.change(null);let a=y(t.optionsRef);a&&(a.scrollTop=0),t.goToOption(T.Nothing)}let d=f(()=>{var a;let R=t.value.value;return y(t.inputRef)?typeof o.displayValue<"u"&&R!==void 0?(a=o.displayValue(R))!=null?a:"":typeof R=="string"?R:"":""});G(()=>{_([d,t.comboboxState,m],([a,R],[S,F])=>{if(r.value)return;let C=y(t.inputRef);C&&((F===0&&R===1||a!==S)&&(C.value=a),requestAnimationFrame(()=>{var i;if(r.value||!C||((i=m.value)==null?void 0:i.activeElement)!==C)return;let{selectionStart:D,selectionEnd:N}=C;Math.abs((N??0)-(D??0))===0&&D===0&&C.setSelectionRange(C.value.length,C.value.length)}))},{immediate:!0}),_([t.comboboxState],([a],[R])=>{if(a===0&&R===1){if(r.value)return;let S=y(t.inputRef);if(!S)return;let F=S.value,{selectionStart:C,selectionEnd:i,selectionDirection:D}=S;S.value="",S.value=F,D!==null?S.setSelectionRange(C,i,D):S.setSelectionRange(C,i)}})});let b=A(!1);function x(){b.value=!0}function E(){fe().nextFrame(()=>{b.value=!1})}function V(a){switch(r.value=!0,a.key){case k.Enter:if(r.value=!1,t.comboboxState.value!==0||b.value)return;if(a.preventDefault(),a.stopPropagation(),t.activeOptionIndex.value===null){t.closeCombobox();return}t.selectActiveOption(),t.mode.value===0&&t.closeCombobox();break;case k.ArrowDown:return r.value=!1,a.preventDefault(),a.stopPropagation(),$(t.comboboxState.value,{0:()=>t.goToOption(T.Next),1:()=>t.openCombobox()});case k.ArrowUp:return r.value=!1,a.preventDefault(),a.stopPropagation(),$(t.comboboxState.value,{0:()=>t.goToOption(T.Previous),1:()=>{t.openCombobox(),j(()=>{t.value.value||t.goToOption(T.Last)})}});case k.Home:if(a.shiftKey)break;return r.value=!1,a.preventDefault(),a.stopPropagation(),t.goToOption(T.First);case k.PageUp:return r.value=!1,a.preventDefault(),a.stopPropagation(),t.goToOption(T.First);case k.End:if(a.shiftKey)break;return r.value=!1,a.preventDefault(),a.stopPropagation(),t.goToOption(T.Last);case k.PageDown:return r.value=!1,a.preventDefault(),a.stopPropagation(),t.goToOption(T.Last);case k.Escape:if(r.value=!1,t.comboboxState.value!==0)return;a.preventDefault(),t.optionsRef.value&&!t.optionsPropsRef.value.static&&a.stopPropagation(),t.nullable.value&&t.mode.value===0&&t.value.value===null&&u(),t.closeCombobox();break;case k.Tab:if(r.value=!1,t.comboboxState.value!==0)return;t.mode.value===0&&t.selectActiveOption(),t.closeCombobox();break}}function B(a){g("change",a),t.nullable.value&&t.mode.value===0&&a.target.value===""&&u(),t.openCombobox()}function w(){r.value=!1}let O=f(()=>{var a,R,S,F;return(F=(S=(R=o.defaultValue)!=null?R:t.defaultValue.value!==void 0?(a=o.displayValue)==null?void 0:a.call(o,t.defaultValue.value):null)!=null?S:t.defaultValue.value)!=null?F:""});return()=>{var a,R,S,F,C,i;let D={open:t.comboboxState.value===0},{id:N,displayValue:l,onChange:s,...v}=o,n={"aria-controls":(a=t.optionsRef.value)==null?void 0:a.id,"aria-expanded":t.comboboxState.value===0,"aria-activedescendant":t.activeOptionIndex.value===null||(R=t.options.value[t.activeOptionIndex.value])==null?void 0:R.id,"aria-labelledby":(C=(S=y(t.labelRef))==null?void 0:S.id)!=null?C:(F=y(t.buttonRef))==null?void 0:F.id,"aria-autocomplete":"list",id:N,onCompositionstart:x,onCompositionend:E,onKeydown:V,onInput:B,onBlur:w,role:"combobox",type:(i=h.type)!=null?i:"text",tabIndex:0,ref:t.inputRef,defaultValue:O.value,disabled:t.disabled.value===!0?!0:void 0};return L({ourProps:n,theirProps:v,slot:D,attrs:h,slots:P,features:J.RenderStrategy|J.Static,name:"ComboboxInput"})}}}),Fe=M({name:"ComboboxOptions",props:{as:{type:[Object,String],default:"ul"},static:{type:Boolean,default:!1},unmount:{type:Boolean,default:!0},hold:{type:[Boolean],default:!1}},setup(o,{attrs:g,slots:h,expose:P}){let e=K("ComboboxOptions"),t=`headlessui-combobox-options-${H()}`;P({el:e.optionsRef,$el:e.optionsRef}),W(()=>{e.optionsPropsRef.value.static=o.static}),W(()=>{e.optionsPropsRef.value.hold=o.hold});let m=le(),r=f(()=>m!==null?(m.value&U.Open)===U.Open:e.comboboxState.value===0);return xe({container:f(()=>y(e.optionsRef)),enabled:f(()=>e.comboboxState.value===0),accept(u){return u.getAttribute("role")==="option"?NodeFilter.FILTER_REJECT:u.hasAttribute("role")?NodeFilter.FILTER_SKIP:NodeFilter.FILTER_ACCEPT},walk(u){u.setAttribute("role","none")}}),()=>{var u,d,b;let x={open:e.comboboxState.value===0},E={"aria-labelledby":(b=(u=y(e.labelRef))==null?void 0:u.id)!=null?b:(d=y(e.buttonRef))==null?void 0:d.id,id:t,ref:e.optionsRef,role:"listbox","aria-multiselectable":e.mode.value===1?!0:void 0},V=X(o,["hold"]);return L({ourProps:E,theirProps:V,slot:x,attrs:g,slots:h,features:J.RenderStrategy|J.Static,visible:r.value,name:"ComboboxOptions"})}}}),Ae=M({name:"ComboboxOption",props:{as:{type:[Object,String],default:"li"},value:{type:[Object,String,Number,Boolean]},disabled:{type:Boolean,default:!1}},setup(o,{slots:g,attrs:h,expose:P}){let e=K("ComboboxOption"),t=`headlessui-combobox-option-${H()}`,m=A(null);P({el:m,$el:m});let r=f(()=>e.activeOptionIndex.value!==null?e.options.value[e.activeOptionIndex.value].id===t:!1),u=f(()=>$(e.mode.value,{0:()=>e.compare(c(e.value.value),c(o.value)),1:()=>c(e.value.value).some(O=>e.compare(c(O),c(o.value)))})),d=f(()=>({disabled:o.disabled,value:o.value,domRef:m}));G(()=>e.registerOption(t,d)),be(()=>e.unregisterOption(t)),W(()=>{e.comboboxState.value===0&&r.value&&e.activationTrigger.value!==0&&j(()=>{var O,a;return(a=(O=y(m))==null?void 0:O.scrollIntoView)==null?void 0:a.call(O,{block:"nearest"})})});function b(O){if(o.disabled)return O.preventDefault();e.selectOption(t),e.mode.value===0&&e.closeCombobox(),me()||requestAnimationFrame(()=>{var a;return(a=y(e.inputRef))==null?void 0:a.focus()})}function x(){if(o.disabled)return e.goToOption(T.Nothing);e.goToOption(T.Specific,t)}let E=ve();function V(O){E.update(O)}function B(O){E.wasMoved(O)&&(o.disabled||r.value||e.goToOption(T.Specific,t,0))}function w(O){E.wasMoved(O)&&(o.disabled||r.value&&(e.optionsPropsRef.value.hold||e.goToOption(T.Nothing)))}return()=>{let{disabled:O}=o,a={active:r.value,selected:u.value,disabled:O},R={id:t,ref:m,role:"option",tabIndex:O===!0?void 0:-1,"aria-disabled":O===!0?!0:void 0,"aria-selected":u.value,disabled:void 0,onClick:b,onFocus:x,onPointerenter:V,onMouseenter:V,onPointermove:B,onMousemove:B,onPointerleave:w,onMouseleave:w};return L({ourProps:R,theirProps:o,slot:a,attrs:h,slots:g,name:"ComboboxOption"})}}});export{Ee as G,Pe as J,Ve as Q,Te as W,Fe as X,Ae as Y};
